<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <title>MT Free Tools - All-in-One Calculator Suite</title> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5">

    <style>
        /* CSS is unchanged and complete. Omitted for brevity. */
        :root{--primary-color:#4f46e5;--secondary-color:#6366f1;--background-color:#f4f4f5;--card-background:#fff;--text-color:#1f2937;--subtle-text-color:#6b7280;--border-color:#e5e7eb;--shadow-color:rgba(0,0,0,.05);--success-color:#10b981;--error-color:#ef4444;--star-color:#facc15}body.dark-mode{--primary-color:#6366f1;--secondary-color:#818cf8;--background-color:#1f2937;--card-background:#374151;--text-color:#f3f4f6;--subtle-text-color:#9ca3af;--border-color:#4b5563;--shadow-color:rgba(0,0,0,.2)}*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Roboto',Arial,Helvetica,sans-serif;background-color:var(--background-color);color:var(--text-color);line-height:1.6;transition:background-color .3s,color .3s}.container{max-width:1200px;margin:0 auto;padding:0 20px}h1,h2,h3{color:var(--primary-color);margin-bottom:1rem;font-weight:700;transition:color .3s}header{background-color:var(--card-background);box-shadow:0 2px 4px var(--shadow-color);padding:1rem 0;position:sticky;top:0;z-index:1000;transition:background-color .3s}header .container{display:flex;justify-content:space-between;align-items:center;gap:1.5rem}.logo{font-size:1.5rem;font-weight:700;color:var(--primary-color);flex-shrink:0}.search-container{flex-grow:1;max-width:500px}#search-bar{width:100%;padding:.65rem 1rem;border:1px solid var(--border-color);border-radius:20px;font-size:1rem;background-color:var(--background-color);transition:all .3s;color:var(--text-color)}#search-bar:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px color-mix(in srgb,var(--primary-color) 20%,transparent)}.nav-actions-wrapper{display:flex;align-items:center;gap:1.5rem}.header-actions{display:flex;align-items:center;gap:1rem}nav ul{list-style:none;display:flex;gap:1.5rem;flex-shrink:0}nav a{text-decoration:none;color:var(--text-color);font-weight:500;transition:color .3s ease}nav a:hover{color:var(--primary-color)}.theme-switch-wrapper{display:flex;align-items:center;gap:.5rem}.theme-switch{position:relative;display:inline-block;width:44px;height:24px}.theme-switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider:before{position:absolute;content:"‚òÄÔ∏è";height:18px;width:18px;left:4px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px}input:checked+.slider{background-color:var(--primary-color)}input:checked+.slider:before{transform:translateX(18px);content:"üåô"}#history-btn{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-color);transition:color .3s}#history-btn:hover{color:var(--primary-color)}main{padding:2rem 0}section{padding:60px 0;border-bottom:1px solid var(--border-color)}section:last-of-type{border-bottom:none}#home{text-align:center}#home h1{font-size:2.5rem}#home p{font-size:1.1rem;color:var(--subtle-text-color);max-width:600px;margin:0 auto}.tools-layout{display:flex;gap:2rem;align-items:flex-start}#sidebar{flex:0 0 220px;background-color:var(--card-background);padding:1.5rem;border-radius:8px;box-shadow:0 4px 6px var(--shadow-color);position:sticky;top:100px;transition:background-color .3s,box-shadow .3s}#sidebar h3{margin-top:0;margin-bottom:1rem;font-size:1.2rem;border-bottom:1px solid var(--border-color);padding-bottom:.75rem}#category-list{list-style:none}#category-list li a{display:block;padding:.6rem 1rem;margin:.25rem 0;text-decoration:none;color:var(--text-color);border-radius:6px;font-weight:500;transition:background-color .2s,color .2s}#category-list li a:hover{background-color:color-mix(in srgb,var(--primary-color) 10%,transparent);color:var(--primary-color)}#category-list li a.active{background-color:var(--primary-color);color:#fff}#tools-content-area{flex:1}.tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}#no-results-message{display:none;text-align:center;padding:3rem;margin-top:1rem;background-color:var(--card-background);border-radius:8px;color:var(--subtle-text-color);font-size:1.1rem}.tool-card{background-color:var(--card-background);border-radius:8px;padding:1.5rem;box-shadow:0 4px 6px var(--shadow-color);display:flex;flex-direction:column;transition:transform .3s ease,box-shadow .3s ease,background-color .3s}.tool-card:hover{transform:translateY(-5px);box-shadow:0 10px 15px color-mix(in srgb,var(--shadow-color) 100%,#000)}.tool-card .icon{font-size:2.5rem;margin-bottom:1rem}.tool-card h3{font-size:1.2rem;margin-bottom:.5rem}.tool-card p{color:var(--subtle-text-color);flex-grow:1;margin-bottom:1.5rem}.tool-card .open-btn{background-color:var(--primary-color);color:#fff;border:none;padding:.75rem 1rem;border-radius:6px;cursor:pointer;font-weight:500;text-align:center;transition:background-color .3s ease}.tool-card .open-btn:hover{background-color:var(--secondary-color)}#contact-form{max-width:600px;margin:2rem auto 0;text-align:left}.submit-btn{background-color:var(--primary-color);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:6px;cursor:pointer;font-weight:500;font-size:1rem;width:100%;transition:background-color .3s ease}footer{background-color:#1f2937;color:#d1d5db;text-align:center;padding:2rem 0;font-size:.9rem}.modal{display:none;position:fixed;z-index:2000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.6);align-items:center;justify-content:center}.modal-content{background-color:var(--card-background);margin:auto;padding:2rem;border:1px solid var(--border-color);width:90%;max-width:500px;border-radius:8px;box-shadow:0 10px 25px rgba(0,0,0,.2);position:relative;animation:fadeIn .3s;transition:background-color .3s,border-color .3s}@keyframes fadeIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.modal-header h3{margin:0;flex-grow:1}.modal-actions{display:flex;align-items:center;gap:1rem}#favorite-btn{background:none;border:none;cursor:pointer;font-size:1.5rem;color:var(--subtle-text-color);transition:color .2s,transform .2s}#favorite-btn:hover{transform:scale(1.2)}#favorite-btn.is-favorite{color:var(--star-color)}.close-button{color:var(--subtle-text-color);font-size:28px;font-weight:700;cursor:pointer;transition:color .3s}.close-button:hover,.close-button:focus{color:var(--text-color)}#calculator-container h3{margin-top:0}.form-group{margin-bottom:1rem}.form-group label{display:block;margin-bottom:.5rem;font-weight:500}.form-group input,.form-group textarea,.form-group select{width:100%;padding:.75rem;border:1px solid var(--border-color);border-radius:6px;font-size:1rem;background-color:var(--background-color);color:var(--text-color);transition:all .3s}.form-group textarea{resize:vertical;min-height:80px}.calculate-btn{background-color:var(--success-color);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:6px;cursor:pointer;font-weight:500;font-size:1rem;width:100%;transition:background-color .3s ease}.calculate-btn:hover{opacity:.9}#calculator-result{margin-top:1.5rem;padding:1rem;border-radius:6px;background-color:color-mix(in srgb,var(--primary-color) 8%,transparent);font-weight:500;display:none;border:1px solid var(--border-color)}#calculator-result.error{background-color:#fee2e2;color:var(--error-color)}#calculator-result.success{background-color:#d1fae5;color:var(--success-color)}.bmi-gauge{width:100%;height:20px;background:linear-gradient(to right,#60a5fa,#34d399,#facc15,#f87171,#ef4444);border-radius:10px;margin-top:.5rem;position:relative}.bmi-indicator{width:4px;height:26px;background-color:var(--text-color);border-radius:2px;position:absolute;top:-3px;transform:translateX(-50%);transition:left .5s ease}.modal-footer-actions{display:flex;gap:1rem;margin-top:1.5rem}.action-btn{flex-grow:1;padding:.5rem 1rem;background-color:var(--background-color);border:1px solid var(--border-color);color:var(--text-color);border-radius:6px;cursor:pointer;transition:all .3s;font-weight:500}.action-btn:hover{background-color:var(--border-color)}.toast-notification{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background-color:#333;color:#fff;padding:10px 20px;border-radius:6px;z-index:3000;opacity:0;transition:opacity .3s}#history-panel{display:none;position:fixed;top:0;right:0;width:100%;max-width:350px;height:100%;background-color:var(--card-background);z-index:2500;box-shadow:-5px 0 15px rgba(0,0,0,.2);transform:translateX(100%);transition:transform .4s ease-in-out}#history-panel.open{display:block;transform:translateX(0)}.history-header{display:flex;justify-content:space-between;align-items:center;padding:1rem;border-bottom:1px solid var(--border-color)}.history-header h3{margin:0}#history-list{list-style:none;padding:1rem;height:calc(100% - 130px);overflow-y:auto}#history-list li{background-color:var(--background-color);padding:.75rem;border-radius:6px;margin-bottom:.5rem;font-size:.9rem}#history-list .tool-name{font-weight:700;color:var(--primary-color);display:block}#history-list .result-text{color:var(--subtle-text-color)}.history-footer{padding:1rem;border-top:1px solid var(--border-color);position:absolute;bottom:0;width:100%}#clear-history-btn{width:100%;background-color:var(--error-color);color:#fff}@media (max-width:992px){.tools-layout{flex-direction:column}#sidebar{position:static;width:100%;margin-bottom:2rem}#category-list{display:flex;flex-wrap:wrap;gap:.5rem}#category-list li{flex-grow:1}#category-list li a{text-align:center}}@media (max-width:768px){header .container{flex-direction:column;gap:1rem}.search-container{width:100%;max-width:none;order:2}.nav-actions-wrapper{order:3;flex-wrap:wrap;justify-content:center}nav{width:100%}nav ul{justify-content:center}}@media print{body *{visibility:hidden}.modal,.modal *{visibility:visible}.modal{position:absolute;left:0;top:0;width:100%;max-width:100%;box-shadow:none;border:none}.modal-header .modal-actions,.close-button,.calculate-btn,.modal-footer-actions{display:none}}
    </style>
</head>
<body class="">
    <!-- The HTML structure is unchanged from previous version -->
    <header>
        <div class="container">
            <div class="logo">MT Free Tools</div>
            <div class="search-container">
                <input type="text" id="search-bar" placeholder="üîé Search for a tool...">
            </div>
            <div class="nav-actions-wrapper">
                <nav>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#tools">Tools</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <button id="history-btn" title="Calculation History">üìú</button>
                    <div class="theme-switch-wrapper">
                        <label class="theme-switch" for="theme-toggle">
                            <input type="checkbox" id="theme-toggle" />
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section id="home">
            <div class="container">
                <h1>All-in-One Calculator Suite</h1>
                <p>A comprehensive collection of free, easy-to-use online calculators for finance, health, math, and more. Instantly get the answers you need.</p>
            </div>
        </section>

        <section id="tools">
            <div class="container">
                <h2>Our Tools</h2>
                <div class="tools-layout">
                    <aside id="sidebar">
                        <h3>Categories</h3>
                        <ul id="category-list"></ul>
                    </aside>
                    <div id="tools-content-area">
                        <div id="tools-grid" class="tools-grid"></div>
                        <div id="no-results-message">
                            <h3>No Tools Found</h3>
                            <p>Sorry, your search did not match any tools in this category. Try a different keyword or category.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="contact">
            <div class="container">
                <h2 style="text-align: center;">Get In Touch</h2>
                <p style="text-align: center;">Have questions or a suggestion for a new tool? Let us know!</p>
                <form id="contact-form" action="https://formspree.io/f/YOUR_FORMSPREE_ID" method="POST">
                    <div class="form-group">
                        <label for="email">Your Email:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="suggestion">Suggestion / Message:</label>
                        <textarea id="suggestion" name="suggestion" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Send Suggestion</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>¬© 2024 MT Free Tools. All Rights Reserved.</p>
            <p>Contact: <a href="mailto:Methongchakma02@gmail.com">Methongchakma02@gmail.com</a></p>
            <p class="footer-credit"> Designed by üòé Methongchakma ü•¥ </p>
        </div>
    </footer>
    
    <div id="calculator-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Calculator</h3>
                <div class="modal-actions">
                    <button id="favorite-btn" title="Add to favorites">‚≠ê</button>
                    <span class="close-button">√ó</span>
                </div>
            </div>
            <div id="calculator-container"></div>
            <div id="calculator-result"></div>
            <div class="modal-footer-actions">
                <button id="share-btn" class="action-btn">üîó Share</button>
                <button id="print-btn" class="action-btn">üñ®Ô∏è Print</button>
            </div>
        </div>
    </div>
    <div id="history-panel">
        <div class="history-header"><h3>Calculation History</h3><span class="close-button">√ó</span></div>
        <ul id="history-list"></ul>
        <div class="history-footer"><button id="clear-history-btn" class="action-btn">Clear History</button></div>
    </div>
    <div id="toast" class="toast-notification">Link copied to clipboard!</div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // =========================================================================
        //  TOOL DEFINITIONS (COMPLETE LIST)
        // =========================================================================
        const tools = [
            // --- GENERAL, FINANCE, HEALTH & FITNESS, MATHS (ALL PREVIOUS TOOLS) ---
            { id: 'age-calculator', icon: 'üéÇ', name: 'Age Calculator', category: 'General', description: 'Calculate age in years, months, days, hours, and more from a birth date.', getHtml: () => `<h3>Age Calculator</h3><div class="form-group"><label for="birthdate">Date of Birth</label><input name="birthdate" type="date" id="birthdate" required></div><button class="calculate-btn">Calculate Age</button>`, calculate: () => { const birthdateInput = document.getElementById('birthdate').value; if (!birthdateInput) return { error: true, result: "Please enter a valid date of birth." }; const birthDate = new Date(birthdateInput); const now = new Date(); if (birthDate > now) return { error: true, result: "Date of birth cannot be in the future." }; let years = now.getFullYear() - birthDate.getFullYear(); let months = now.getMonth() - birthDate.getMonth(); let days = now.getDate() - birthDate.getDate(); if (days < 0) { months--; days += new Date(now.getFullYear(), now.getMonth(), 0).getDate(); } if (months < 0) { years--; months += 12; } const totalDays = Math.floor((now - birthDate) / (1000 * 60 * 60 * 24)); const totalHours = totalDays * 24; const totalSeconds = totalHours * 3600; return { error: false, result: `<strong>Your Age:</strong> ${years} years, ${months} months, and ${days} days.<br><strong>Total Months:</strong> ${years * 12 + months}<br><strong>Total Days:</strong> ${totalDays.toLocaleString()}<br><strong>Total Hours:</strong> ${totalHours.toLocaleString()}<br><strong>Total Seconds:</strong> ${totalSeconds.toLocaleString()}` };} },
            { id: 'percentage-calculator', icon: '‚ûó', name: 'Percentage Calculator', category: 'Math & Stats', description: 'Calculate what percentage X is of Y, or what is X% of Y.', getHtml: () => `<h3>Percentage Calculator</h3><div class="form-group"><label for="percent-val1">What is</label><input name="v1" type="number" id="percent-val1" placeholder="e.g., 5"></div><div class="form-group"><label for="percent-val2">percent of</label><input name="v2" type="number" id="percent-val2" placeholder="e.g., 20"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const val1 = parseFloat(document.getElementById('percent-val1').value); const val2 = parseFloat(document.getElementById('percent-val2').value); if (isNaN(val1) || isNaN(val2)) return { error: true, result: "Please enter valid numbers." }; const result = (val1 / 100) * val2; return { error: false, result: `${val1}% of ${val2} is <strong>${result.toFixed(2)}</strong>.` }; } },
            { id: 'average-calculator', icon: 'üìä', name: 'Average Calculator', category: 'Math & Stats', description: 'Calculate the average of a series of numbers.', getHtml: () => `<h3>Average Calculator</h3><div class="form-group"><label for="avg-numbers">Enter numbers (comma-separated)</label><textarea name="numbers" id="avg-numbers" placeholder="e.g., 10, 20, 30, 40, 50"></textarea></div><button class="calculate-btn">Calculate Average</button>`, calculate: () => { const numbersStr = document.getElementById('avg-numbers').value; if (!numbersStr) return { error: true, result: "Please enter some numbers." }; const numbersArr = numbersStr.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n)); if (numbersArr.length === 0) return { error: true, result: "No valid numbers were entered." }; const sum = numbersArr.reduce((acc, curr) => acc + curr, 0); const avg = sum / numbersArr.length; return { error: false, result: `The average is <strong>${avg.toFixed(2)}</strong>.` }; } },
            { id: 'sales-tax-calculator', icon: 'üõí', name: 'Sales Tax Calculator', category: 'Finance', description: 'Quickly calculate sales tax and the total price of an item.', getHtml: () => `<h3>Sales Tax Calculator</h3><div class="form-group"><label for="st-amount">Price Before Tax</label><input name="amount" type="number" id="st-amount" placeholder="e.g., 100"></div><div class="form-group"><label for="st-rate">Tax Rate (%)</label><input name="rate" type="number" id="st-rate" placeholder="e.g., 7.5"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const amount = parseFloat(document.getElementById('st-amount').value); const rate = parseFloat(document.getElementById('st-rate').value); if (isNaN(amount) || isNaN(rate)) return { error: true, result: "Please enter valid numbers." }; const taxAmount = amount * (rate / 100); const totalAmount = amount + taxAmount; return { error: false, result: `Sales Tax: <strong>$${taxAmount.toFixed(2)}</strong><br>Total Price: <strong>$${totalAmount.toFixed(2)}</strong>` }; } },
            { id: 'margin-calculator', icon: 'üí∞', name: 'Margin Calculator', category: 'Finance', description: 'Calculate profit margin, cost, and revenue.', getHtml: () => `<h3>Margin Calculator</h3><div class="form-group"><label for="m-cost">Cost</label><input name="cost" type="number" id="m-cost" placeholder="e.g., 75"></div><div class="form-group"><label for="m-revenue">Revenue</label><input name="revenue" type="number" id="m-revenue" placeholder="e.g., 100"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const cost = parseFloat(document.getElementById('m-cost').value); const revenue = parseFloat(document.getElementById('m-revenue').value); if (isNaN(cost) || isNaN(revenue) || revenue === 0) return { error: true, result: "Please enter valid numbers (Revenue must not be 0)." }; const profit = revenue - cost; const margin = (profit / revenue) * 100; return { error: false, result: `Profit: <strong>$${profit.toFixed(2)}</strong><br>Margin: <strong>${margin.toFixed(2)}%</strong>` }; } },
            { id: 'bmi-calculator', icon: 'üí™', name: 'BMI Calculator', category: 'Health & Fitness', description: 'Calculate your Body Mass Index (BMI).', getHtml: () => `<h3>BMI Calculator</h3><div class="form-group"><label for="bmi-height">Height (cm)</label><input name="height" type="number" id="bmi-height" placeholder="e.g., 175"></div><div class="form-group"><label for="bmi-weight">Weight (kg)</label><input name="weight" type="number" id="bmi-weight" placeholder="e.g., 70"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const height = parseFloat(document.getElementById('bmi-height').value); const weight = parseFloat(document.getElementById('bmi-weight').value); if (isNaN(height) || isNaN(weight) || height <= 0 || weight <= 0) return { error: true, result: "Please enter valid height and weight." }; const heightInMeters = height / 100; const bmi = weight / (heightInMeters * heightInMeters); let category = ''; if (bmi < 18.5) category = 'Underweight'; else if (bmi < 25) category = 'Normal weight'; else if (bmi < 30) category = 'Overweight'; else category = 'Obese'; const pos = Math.min(100, Math.max(0, (bmi - 15) / (40 - 15) * 100)); return { error: false, result: `Your BMI is <strong>${bmi.toFixed(1)}</strong> (${category})<div class="bmi-gauge"><div class="bmi-indicator" style="left: ${pos}%;"></div></div>` }; } },
            { id: 'loan-calculator', icon: 'üè¶', name: 'Loan Calculator', category: 'Finance', description: 'Calculate monthly payments for a loan.', getHtml: () => `<h3>Loan Calculator</h3><div class="form-group"><label for="l-amount">Loan Amount</label><input name="amount" type="number" id="l-amount" placeholder="e.g., 10000"></div><div class="form-group"><label for="l-rate">Annual Interest Rate (%)</label><input name="rate" type="number" id="l-rate" placeholder="e.g., 5"></div><div class="form-group"><label for="l-term">Loan Term (Years)</label><input name="term" type="number" id="l-term" placeholder="e.g., 5"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const principal = parseFloat(document.getElementById('l-amount').value); const rate = parseFloat(document.getElementById('l-rate').value); const term = parseFloat(document.getElementById('l-term').value); if (isNaN(principal) || isNaN(rate) || isNaN(term) || principal <= 0 || rate <= 0 || term <= 0) return { error: true, result: "Please enter valid positive numbers." }; const monthlyRate = rate / 100 / 12; const numberOfPayments = term * 12; const monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1); const totalPayment = monthlyPayment * numberOfPayments; const totalInterest = totalPayment - principal; return { error: false, result: `Monthly Payment: <strong>$${monthlyPayment.toFixed(2)}</strong><br>Total Payment: <strong>$${totalPayment.toFixed(2)}</strong><br>Total Interest: <strong>$${totalInterest.toFixed(2)}</strong>` }; } },
            { id: 'investment-calculator', icon: 'üìà', name: 'Investment Calculator', category: 'Finance', description: 'Calculate the future value of an investment.', getHtml: () => `<h3>Investment Calculator</h3><div class="form-group"><label for="inv-principal">Initial Investment</label><input name="principal" type="number" id="inv-principal" placeholder="1000"></div><div class="form-group"><label for="inv-contrib">Monthly Contribution</label><input name="contrib" type="number" id="inv-contrib" placeholder="100"></div><div class="form-group"><label for="inv-rate">Annual Rate (%)</label><input name="rate" type="number" id="inv-rate" placeholder="7"></div><div class="form-group"><label for="inv-years">Years to Grow</label><input name="years" type="number" id="inv-years" placeholder="10"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const P = parseFloat(document.getElementById('inv-principal').value); const PMT = parseFloat(document.getElementById('inv-contrib').value); const r = parseFloat(document.getElementById('inv-rate').value) / 100; const t = parseFloat(document.getElementById('inv-years').value); if ([P, PMT, r, t].some(isNaN)) return { error: true, result: "Please enter valid numbers for all fields." }; const n = 12; const i = r / n; const nt = n * t; const fvP = P * Math.pow(1 + i, nt); const fvS = PMT * ((Math.pow(1 + i, nt) - 1) / i); const total = fvP + fvS; const totalContributions = P + (PMT * nt); const totalInterest = total - totalContributions; return { error: false, result: `Future Value: <strong>$${total.toFixed(2)}</strong><br>Total Contributions: <strong>$${totalContributions.toFixed(2)}</strong><br>Total Interest Earned: <strong>$${totalInterest.toFixed(2)}</strong>` }; } },
            { id: 'calorie-calculator', icon: 'üçé', name: 'Calorie Calculator (BMR)', category: 'Health & Fitness', description: 'Estimate your Basal Metabolic Rate (BMR).', getHtml: () => `<h3>Calorie Calculator (BMR)</h3><div class="form-group"><label for="cal-age">Age</label><input name="age" type="number" id="cal-age" placeholder="e.g., 30"></div><div class="form-group"><label for="cal-gender">Gender</label><select name="gender" id="cal-gender"><option value="male">Male</option><option value="female">Female</option></select></div><div class="form-group"><label for="cal-height">Height (cm)</label><input name="height" type="number" id="cal-height" placeholder="e.g., 180"></div><div class="form-group"><label for="cal-weight">Weight (kg)</label><input name="weight" type="number" id="cal-weight" placeholder="e.g., 75"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const age = parseInt(document.getElementById('cal-age').value); const gender = document.getElementById('cal-gender').value; const height = parseFloat(document.getElementById('cal-height').value); const weight = parseFloat(document.getElementById('cal-weight').value); if (isNaN(age) || isNaN(height) || isNaN(weight) || age <= 0 || height <= 0 || weight <= 0) return { error: true, result: "Please enter valid, positive numbers." }; let bmr; if (gender === 'male') { bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age); } else { bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age); } return { error: false, result: `Your estimated BMR is <strong>${bmr.toFixed(0)} calories/day</strong>.` }; } },
            { id: 'tdee-calculator', icon: 'üèÉ', name: 'TDEE Calculator', category: 'Health & Fitness', description: 'Estimate your Total Daily Energy Expenditure.', getHtml: () => `<h3>TDEE Calculator (Mifflin-St Jeor)</h3><div class="form-group"><label for="tdee-age">Age</label><input name="age" type="number" id="tdee-age" placeholder="30"></div><div class="form-group"><label for="tdee-gender">Gender</label><select name="gender" id="tdee-gender"><option value="male">Male</option><option value="female">Female</option></select></div><div class="form-group"><label for="tdee-height">Height (cm)</label><input name="height" type="number" id="tdee-height" placeholder="180"></div><div class="form-group"><label for="tdee-weight">Weight (kg)</label><input name="weight" type="number" id="tdee-weight" placeholder="75"></div><div class="form-group"><label for="tdee-activity">Activity Level</label><select name="activity" id="tdee-activity"><option value="1.2">Sedentary</option><option value="1.375">Lightly Active</option><option value="1.55">Moderately Active</option><option value="1.725">Very Active</option><option value="1.9">Extra Active</option></select></div><button class="calculate-btn">Calculate TDEE</button>`, calculate: () => { const age = parseInt(document.getElementById('tdee-age').value); const gender = document.getElementById('tdee-gender').value; const height = parseFloat(document.getElementById('tdee-height').value); const weight = parseFloat(document.getElementById('tdee-weight').value); const activity = parseFloat(document.getElementById('tdee-activity').value); if (isNaN(age) || isNaN(height) || isNaN(weight) || age <= 0 || height <= 0 || weight <= 0) return { error: true, result: "Please enter valid, positive numbers." }; let bmr; if (gender === 'male') { bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5; } else { bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161; } const tdee = bmr * activity; return { error: false, result: `BMR: <strong>${bmr.toFixed(0)} cal/day</strong><br>TDEE: <strong>${tdee.toFixed(0)} cal/day</strong>` }; } },
            { id: 'discount-calculator', icon: 'üè∑Ô∏è', name: 'Discount Calculator', category: 'Finance', description: 'Calculate the final price after a discount.', getHtml: () => `<h3>Discount Calculator</h3><div class="form-group"><label for="d-price">Original Price</label><input name="price" type="number" id="d-price" placeholder="e.g., 100"></div><div class="form-group"><label for="d-percent">Discount (%)</label><input name="percent" type="number" id="d-percent" placeholder="e.g., 25"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const price = parseFloat(document.getElementById('d-price').value); const percent = parseFloat(document.getElementById('d-percent').value); if (isNaN(price) || isNaN(percent) || percent < 0 || percent > 100) return { error: true, result: "Invalid numbers (Discount 0-100%)." }; const saved = price * (percent / 100); const finalPrice = price - saved; return { error: false, result: `You Save: <strong>$${saved.toFixed(2)}</strong><br>Final Price: <strong>$${finalPrice.toFixed(2)}</strong>` }; } },
            { id: 'tip-calculator', icon: 'üíÅ', name: 'Tip Calculator', category: 'General', description: 'Calculate tips and split the bill among friends.', getHtml: () => `<h3>Tip Calculator</h3><div class="form-group"><label for="tip-bill">Bill Amount</label><input name="bill" type="number" id="tip-bill" placeholder="50.00"></div><div class="form-group"><label for="tip-percent">Tip Percentage</label><input name="percent" type="number" id="tip-percent" value="15"></div><div class="form-group"><label for="tip-people">Number of People</label><input name="people" type="number" id="tip-people" value="1"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const bill = parseFloat(document.getElementById('tip-bill').value); const percent = parseFloat(document.getElementById('tip-percent').value); const people = parseInt(document.getElementById('tip-people').value); if (isNaN(bill) || isNaN(percent) || isNaN(people) || bill <= 0 || people < 1) return { error: true, result: "Please enter valid numbers."}; const tipAmount = bill * (percent / 100); const totalAmount = bill + tipAmount; const perPerson = totalAmount / people; return { error: false, result: `Tip Amount: <strong>$${tipAmount.toFixed(2)}</strong><br>Total Bill: <strong>$${totalAmount.toFixed(2)}</strong><br>${people > 1 ? `Per Person: <strong>$${perPerson.toFixed(2)}</strong>` : ''}` }; } },
            { id: 'expression-calculator', icon: 'üßÆ', name: 'Expression Calculator', category: 'Mathematics', description: 'Evaluate a mathematical expression (e.g., 5 * (10-2)).', getHtml: () => `<h3>Expression Calculator</h3><div class="form-group"><label for="expression-input">Enter Expression</label><input name="expr" type="text" id="expression-input" placeholder="e.g., (10 + 5) * 2 / 3"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const expr = document.getElementById('expression-input').value; if (!expr) return { error: true, result: "Please enter an expression." }; const sanitizedExpr = expr.replace(/[^-()\d/*+.]/g, ''); if (expr !== sanitizedExpr) return { error: true, result: "Invalid characters in expression." }; try { const result = new Function('return ' + sanitizedExpr)(); if (isNaN(result) || !isFinite(result)) return { error: true, result: "Invalid or malformed expression." }; return { error: false, result: `Result: <strong>${result}</strong>` }; } catch (e) { return { error: true, result: "Invalid expression syntax." }; } } },
            { id: 'fraction-calculator', icon: '‚ûó', name: 'Fraction Calculator', category: 'Mathematics', description: 'Add, subtract, multiply, or divide two fractions.', getHtml: () => `<h3>Fraction Calculator</h3><div class="form-group"><label>Fraction 1</label><input name="f1" type="text" id="frac1" placeholder="e.g., 3/4"></div><div class="form-group"><label>Operation</label><select name="op" id="frac-op"><option value="+">+</option><option value="-">-</option><option value="*">*</option><option value="/">/</option></select></div><div class="form-group"><label>Fraction 2</label><input name="f2" type="text" id="frac2" placeholder="e.g., 1/2"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const gcd = (a, b) => b ? gcd(b, a % b) : a; const parseFrac = (str) => str.split('/').map(n => parseInt(n)); const [n1, d1] = parseFrac(document.getElementById('frac1').value); const [n2, d2] = parseFrac(document.getElementById('frac2').value); const op = document.getElementById('frac-op').value; if ([n1, d1, n2, d2].some(isNaN) || d1 === 0 || d2 === 0) return { error: true, result: "Invalid fractions."}; let n, d; if (op === '+') { n = n1 * d2 + n2 * d1; d = d1 * d2; } else if (op === '-') { n = n1 * d2 - n2 * d1; d = d1 * d2; } else if (op === '*') { n = n1 * n2; d = d1 * d2; } else if (op === '/') { n = n1 * d2; d = n2 * d1; } if (d === 0) return { error: true, result: "Result has zero denominator."}; const commonDivisor = gcd(Math.abs(n), Math.abs(d)); return { error: false, result: `Result: <strong>${n/commonDivisor}/${d/commonDivisor}</strong>` }; } },
            { id: 'equation-solver', icon: 'üî£', name: 'Equation Solver (Linear)', category: 'Mathematics', description: 'Solve linear equations of the form ax + b = c.', getHtml: () => `<h3>Linear Equation Solver</h3><div class="form-group"><label for="eq-a">Value of a (in ax)</label><input name="a" type="number" id="eq-a" placeholder="2"></div><div class="form-group"><label for="eq-b">Value of b</label><input name="b" type="number" id="eq-b" placeholder="5"></div><div class="form-group"><label for="eq-c">Value of c</label><input name="c" type="number" id="eq-c" placeholder="15"></div><p style="font-size:0.9rem; color:var(--subtle-text-color);">Solves for x in: ax + b = c</p><button class="calculate-btn">Solve for x</button>`, calculate: () => { const a = parseFloat(document.getElementById('eq-a').value); const b = parseFloat(document.getElementById('eq-b').value); const c = parseFloat(document.getElementById('eq-c').value); if ([a, b, c].some(isNaN)) return { error: true, result: "Please enter valid numbers."}; if (a === 0) return { error: true, result: "Value 'a' cannot be zero."}; const x = (c - b) / a; return { error: false, result: `x = <strong>${x}</strong>` }; } },
            { id: 'exponent-calculator', icon: '¬≤ ', name: 'Exponent Calculator', category: 'Mathematics', description: 'Calculate the result of a base raised to a power.', getHtml: () => `<h3>Exponent Calculator</h3><div class="form-group"><label for="exp-base">Base</label><input name="base" type="number" id="exp-base" placeholder="2"></div><div class="form-group"><label for="exp-power">Exponent</label><input name="power" type="number" id="exp-power" placeholder="10"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const base = parseFloat(document.getElementById('exp-base').value); const power = parseFloat(document.getElementById('exp-power').value); if (isNaN(base) || isNaN(power)) return { error: true, result: "Invalid numbers."}; return { error: false, result: `${base} ^ ${power} = <strong>${Math.pow(base, power)}</strong>` }; } },
            { id: 'sqrt-calculator', icon: '‚àö', name: 'Square Root Calculator', category: 'Mathematics', description: 'Calculate the square root of a number.', getHtml: () => `<h3>Square Root Calculator</h3><div class="form-group"><label for="sqrt-num">Number</label><input name="num" type="number" id="sqrt-num" placeholder="144"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const num = parseFloat(document.getElementById('sqrt-num').value); if (isNaN(num) || num < 0) return { error: true, result: "Please enter a non-negative number."}; return { error: false, result: `‚àö${num} = <strong>${Math.sqrt(num)}</strong>` }; } },
            { id: 'lcm-hcf-calculator', icon: 'üî¢', name: 'LCM & HCF Calculator', category: 'Mathematics', description: 'Find the Least Common Multiple and Highest Common Factor.', getHtml: () => `<h3>LCM & HCF Calculator</h3><div class="form-group"><label for="lh-num1">Number 1</label><input name="n1" type="number" id="lh-num1" placeholder="12"></div><div class="form-group"><label for="lh-num2">Number 2</label><input name="n2" type="number" id="lh-num2" placeholder="18"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const n1 = parseInt(document.getElementById('lh-num1').value); const n2 = parseInt(document.getElementById('lh-num2').value); if (isNaN(n1) || isNaN(n2) || n1 <= 0 || n2 <= 0) return { error: true, result: "Please enter positive integers."}; const gcd = (a, b) => b ? gcd(b, a % b) : a; const hcf = gcd(n1, n2); const lcm = (n1 * n2) / hcf; return { error: false, result: `HCF (GCD): <strong>${hcf}</strong><br>LCM: <strong>${lcm}</strong>` }; } },
            { id: 'log-calculator', icon: 'ü™µ', name: 'Logarithm Calculator', category: 'Mathematics', description: 'Calculate the logarithm of a number to a specified base.', getHtml: () => `<h3>Logarithm Calculator</h3><div class="form-group"><label for="log-num">Number</label><input name="num" type="number" id="log-num" placeholder="100"></div><div class="form-group"><label for="log-base">Base</label><input name="base" type="number" id="log-base" placeholder="10"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const num = parseFloat(document.getElementById('log-num').value); const base = parseFloat(document.getElementById('log-base').value); if (isNaN(num) || isNaN(base) || num <= 0 || base <= 0 || base === 1) return { error: true, result: "Invalid input. Number and base must be > 0, base cannot be 1."}; const result = Math.log(num) / Math.log(base); return { error: false, result: `log<sub>${base}</sub>(${num}) = <strong>${result.toFixed(5)}</strong>` }; } },
            { id: 'factorial-calculator', icon: '!', name: 'Factorial Calculator', category: 'Mathematics', description: 'Calculate the factorial of a non-negative integer.', getHtml: () => `<h3>Factorial Calculator</h3><div class="form-group"><label for="fact-num">Number (n!)</label><input name="num" type="number" id="fact-num" placeholder="5"></div><button class="calculate-btn">Calculate</button>`, calculate: () => { const num = parseInt(document.getElementById('fact-num').value); if (isNaN(num) || num < 0) return { error: true, result: "Please enter a non-negative integer."}; if (num > 170) return { error: true, result: "Input too large. Result will be Infinity."}; let result = 1; for (let i = 2; i <= num; i++) result *= i; return { error: false, result: `${num}! = <strong>${result.toLocaleString()}</strong>` }; } },

            // --- NEW: UNIT CONVERSION TOOLS ---
            {
                id: 'length-converter', icon: 'üìè', name: 'Length Converter', category: 'Unit Conversion', description: 'Convert between different units of length.',
                getHtml: () => `<h3>Length Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="m">Meters</option><option value="km">Kilometers</option><option value="cm">Centimeters</option><option value="mi">Miles</option><option value="ft">Feet</option><option value="in">Inches</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="m">Meters</option><option value="km">Kilometers</option><option value="cm">Centimeters</option><option value="mi" selected>Miles</option><option value="ft">Feet</option><option value="in">Inches</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'m':1,'km':1e3,'cm':.01,'mi':1609.34,'ft':.3048,'in':.0254};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'weight-converter', icon: '‚öñÔ∏è', name: 'Weight/Mass Converter', category: 'Unit Conversion', description: 'Convert between different units of weight and mass.',
                getHtml: () => `<h3>Weight Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="kg">Kilograms</option><option value="g">Grams</option><option value="lb">Pounds</option><option value="oz">Ounces</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="kg">Kilograms</option><option value="g">Grams</option><option value="lb" selected>Pounds</option><option value="oz">Ounces</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'kg':1,'g':.001,'lb':0.453592,'oz':0.0283495};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'temp-converter', icon: 'üå°Ô∏è', name: 'Temperature Converter', category: 'Unit Conversion', description: 'Convert between Celsius, Fahrenheit, and Kelvin.',
                getHtml: () => `<h3>Temperature Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="100"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="c">Celsius</option><option value="f">Fahrenheit</option><option value="k">Kelvin</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="c">Celsius</option><option value="f" selected>Fahrenheit</option><option value="k">Kelvin</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};let k;switch(f){case'c':k=v+273.15;break;case'f':k=(v-32)*5/9+273.15;break;case'k':k=v}let r;switch(t){case'c':r=k-273.15;break;case'f':r=(k-273.15)*9/5+32;break;case'k':r=k}return{error:!1,result:`<strong>${r.toFixed(2)}</strong> ¬∞${t.toUpperCase()}`}}
            },
            {
                id: 'area-converter', icon: 'üó∫Ô∏è', name: 'Area Converter', category: 'Unit Conversion', description: 'Convert between different units of area.',
                getHtml: () => `<h3>Area Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="sqm">Square Meters</option><option value="sqkm">Square Km</option><option value="sqft">Square Feet</option><option value="acre">Acres</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="sqm">Square Meters</option><option value="sqkm">Square Km</option><option value="sqft" selected>Square Feet</option><option value="acre">Acres</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'sqm':1,'sqkm':1e6,'sqft':0.092903,'acre':4046.86};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'volume-converter', icon: 'üíß', name: 'Volume Converter', category: 'Unit Conversion', description: 'Convert between different units of volume.',
                getHtml: () => `<h3>Volume Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="l">Liters</option><option value="ml">Milliliters</option><option value="gal">Gallons (US)</option><option value="oz">Fluid Ounces (US)</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="l">Liters</option><option value="ml">Milliliters</option><option value="gal" selected>Gallons (US)</option><option value="oz">Fluid Ounces (US)</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'l':1,'ml':.001,'gal':3.78541,'oz':0.0295735};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'speed-converter', icon: 'üèéÔ∏è', name: 'Speed Converter', category: 'Unit Conversion', description: 'Convert between different units of speed.',
                getHtml: () => `<h3>Speed Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="100"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="mps">Meters/sec</option><option value="kph">Km/hour</option><option value="mph">Miles/hour</option><option value="knot">Knots</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="mps">Meters/sec</option><option value="kph" selected>Km/hour</option><option value="mph">Miles/hour</option><option value="knot">Knots</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'mps':1,'kph':0.277778,'mph':0.44704,'knot':0.514444};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'time-converter', icon: 'üïí', name: 'Time Converter', category: 'Unit Conversion', description: 'Convert between different units of time.',
                getHtml: () => `<h3>Time Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="s">Seconds</option><option value="min">Minutes</option><option value="hr">Hours</option><option value="day">Days</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="s" selected>Seconds</option><option value="min">Minutes</option><option value="hr">Hours</option><option value="day">Days</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'s':1,'min':60,'hr':3600,'day':86400};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },
            {
                id: 'data-converter', icon: 'üíæ', name: 'Data Storage Converter', category: 'Unit Conversion', description: 'Convert between different units of data storage.',
                getHtml: () => `<h3>Data Storage Converter</h3><div class="form-group"><input name="value" type="number" id="conv-value" value="1"></div><div class="form-group"><label>From</label><select name="from" id="conv-from"><option value="B">Bytes</option><option value="KB">Kilobytes</option><option value="MB">Megabytes</option><option value="GB">Gigabytes</option><option value="TB">Terabytes</option></select></div><div class="form-group"><label>To</label><select name="to" id="conv-to"><option value="B">Bytes</option><option value="KB" selected>Kilobytes</option><option value="MB">Megabytes</option><option value="GB">Gigabytes</option><option value="TB">Terabytes</option></select></div><button class="calculate-btn">Convert</button>`,
                calculate: () => { const v=parseFloat(document.getElementById('conv-value').value);const f=document.getElementById('conv-from').value;const t=document.getElementById('conv-to').value;if(isNaN(v))return{error:!0,result:"Invalid input."};const m={'B':1,'KB':1024,'MB':1048576,'GB':1073741824,'TB':1099511627776};const r=v*m[f]/m[t];return{error:!1,result:`<strong>${r.toFixed(5)}</strong> ${t}`}}
            },

        ];


        // --- CORE APPLICATION LOGIC (UNCHANGED) ---
        // This part is unchanged and handles all functionality.
        const toolsGrid=document.getElementById("tools-grid"),modal=document.getElementById("calculator-modal"),modalTitle=document.getElementById("modal-title"),modalContainer=document.getElementById("calculator-container"),modalResult=document.getElementById("calculator-result"),closeModalBtns=document.querySelectorAll(".close-button"),searchBar=document.getElementById("search-bar"),noResultsMessage=document.getElementById("no-results-message"),sidebar=document.getElementById("sidebar"),categoryList=document.getElementById("category-list"),themeToggle=document.getElementById("theme-toggle"),favoriteBtn=document.getElementById("favorite-btn"),historyBtn=document.getElementById("history-btn"),historyPanel=document.getElementById("history-panel"),historyList=document.getElementById("history-list"),clearHistoryBtn=document.getElementById("clear-history-btn"),shareBtn=document.getElementById("share-btn"),printBtn=document.getElementById("print-btn"),toast=document.getElementById("toast");let activeCalculatorId=null,activeCategory="All",favorites=JSON.parse(localStorage.getItem("toolFavorites"))||[],calculationHistory=JSON.parse(localStorage.getItem("toolHistory"))||[];function generateToolCards(){toolsGrid.innerHTML=tools.map(e=>`\n                <div class="tool-card" data-category="${e.category}">\n                    <div class="icon">${e.icon}</div>\n                    <h3>${e.name}</h3>\n                    <p>${e.description}</p>\n                    <button class="open-btn" data-tool-id="${e.id}">Open</button>\n                </div>\n            `).join("")}function generateCategories(){let e=["All",...new Set(tools.map(e=>e.category).sort())];favorites.length>0&&e.unshift("Favorites"),categoryList.innerHTML=e.map(e=>`\n                <li><a href="#" data-category="${e}" class="${e===activeCategory?"active":""}">${"Favorites"===e?"‚≠ê ":""}${e}</a></li>\n            `).join("")}function filterTools(){const e=searchBar.value.toLowerCase().trim(),t=toolsGrid.querySelectorAll(".tool-card");let o=0;t.forEach(t=>{const a=t.querySelector(".open-btn").dataset.toolId,r=tools.find(e=>e.id===a),l=r.name.toLowerCase(),s=r.description.toLowerCase();let i="All"===activeCategory||("Favorites"===activeCategory?favorites.includes(a):r.category===activeCategory);(i=i&&(l.includes(e)||s.includes(e)))?t.style.display="flex":t.style.display="none",i&&o++}),noResultsMessage.style.display=0===o?"block":"none"}function applyTheme(e){themeToggle.checked=e,document.body.classList.toggle("dark-mode",e)}function updateFavorites(){localStorage.setItem("toolFavorites",JSON.stringify(favorites));const e="Favorites"===activeCategory;generateCategories(),e&&0===favorites.length&&(activeCategory="All",categoryList.querySelector('a[data-category="All"]').classList.add("active")),filterTools()}function addToHistory(e,t){const o=document.createElement("div");o.innerHTML=t;const a=o.textContent||o.innerText||"";calculationHistory.unshift({toolName:e,result:a.trim(),date:new Date}),calculationHistory.length>10&&calculationHistory.pop(),localStorage.setItem("toolHistory",JSON.stringify(calculationHistory)),renderHistory()}function renderHistory(){historyList.innerHTML=0===calculationHistory.length?"<li>No history yet.</li>":calculationHistory.map(e=>`\n                <li>\n                    <span class="tool-name">${e.toolName}</span>\n                    <span class="result-text">${e.result}</span>\n                </li>\n            `).join("")}function showToast(e){toast.textContent=e,toast.style.opacity="1",setTimeout(()=>{toast.style.opacity="0"},2e3)}function updateUrl(e,t){const o=new URLSearchParams(t).toString();history.pushState(null,"",`#${e}${o?"?"+o:""}`)}function openModal(e,t={}){const o=tools.find(t=>t.id===e);o&&(activeCalculatorId=o.id,modalTitle.textContent=o.name,modalContainer.innerHTML=o.getHtml(),Object.entries(t).forEach(([e,t])=>{const o=modalContainer.querySelector(`[name="${e}"]`);o&&(o.value=decodeURIComponent(t))}),modalResult.innerHTML="",modalResult.style.display="none",favoriteBtn.classList.toggle("is-favorite",favorites.includes(e)),modal.style.display="flex")}function performCalculation(){if(!activeCalculatorId)return;const e=tools.find(e=>e.id===activeCalculatorId);if(!e)return;const{result:t,error:o}=e.calculate();modalResult.innerHTML=t,modalResult.className=o?"error":"success",modalResult.style.display="block",o||(addToHistory(e.name,t),updateUrl(e.id,Object.fromEntries(new FormData(modalContainer.querySelector("form")||modalContainer).entries())))}const closeModal=()=>{modal.style.display="none",activeCalculatorId=null,history.pushState(null,"",window.location.pathname+window.location.search)};function handleUrlChange(){const e=window.location.hash.slice(1);if(!e)return;const[t,o]=e.split("?"),a=Object.fromEntries(new URLSearchParams(o));tools.some(e=>e.id===t)&&(openModal(t,a),Object.keys(a).length>0&&setTimeout(performCalculation,100))}themeToggle.addEventListener("change",()=>{localStorage.setItem("darkMode",themeToggle.checked),applyTheme(themeToggle.checked)}),favoriteBtn.addEventListener("click",()=>{activeCalculatorId&&(favorites.includes(activeCalculatorId)?(favorites.splice(favorites.indexOf(activeCalculatorId),1),favoriteBtn.classList.remove("is-favorite")):(favorites.push(activeCalculatorId),favoriteBtn.classList.add("is-favorite")),updateFavorites())}),historyBtn.addEventListener("click",()=>historyPanel.classList.add("open")),historyPanel.querySelector(".close-button").addEventListener("click",()=>historyPanel.classList.remove("open")),clearHistoryBtn.addEventListener("click",()=>{calculationHistory=[],localStorage.removeItem("toolHistory"),renderHistory()}),shareBtn.addEventListener("click",()=>{navigator.clipboard.writeText(window.location.href),showToast("Link copied to clipboard!")}),printBtn.addEventListener("click",()=>window.print()),sidebar.addEventListener("click",e=>{if("A"===e.target.tagName){e.preventDefault(),activeCategory=e.target.dataset.category,categoryList.querySelectorAll("a").forEach(e=>e.classList.remove("active")),e.target.classList.add("active"),filterTools()}}),searchBar.addEventListener("input",filterTools),toolsGrid.addEventListener("click",e=>{if(e.target.classList.contains("open-btn")){const t=e.target.dataset.toolId;openModal(t),updateUrl(t)}}),modalContainer.addEventListener("click",e=>{e.target.classList.contains("calculate-btn")&&performCalculation()}),closeModalBtns.forEach(e=>e.addEventListener("click",closeModal)),window.addEventListener("click",e=>{e.target!==modal&&e.target!==historyPanel||(closeModal(),historyPanel.classList.remove("open"))}),window.addEventListener("keydown",e=>{"Escape"===e.key&&(closeModal(),historyPanel.classList.remove("open"))}),window.addEventListener("hashchange",handleUrlChange),generateToolCards(),generateCategories(),filterTools(),applyTheme("true"===localStorage.getItem("darkMode")),renderHistory(),handleUrlChange(),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})});

    });
    </script>
</body>
</html>

